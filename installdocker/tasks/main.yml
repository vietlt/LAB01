---
# tasks file for installdocker
- name: Update all Ubuntu packages 
  become: true
  become_method: "sudo"
  apt:
    upgrade: "dist"
    update_cache: true
  when: ansible_distribution == 'Ubuntu'

- name: Install docker for Ubuntu 
  become: true
  become_method: "sudo"
  command: "
    apt-get update && apt-get install -y apt-transport-https \
      ca-certificates curl gnupg2 \
      software-properties-common
    curl -fsSL https://download.docker.com/linux/debian/gpg | apt-key add -

    add-apt-repository \
      "deb [arch=amd64] https://download.docker.com/linux/debian \
       $(lsb_release -cs) stable"

    apt-get update && apt-get install -y docker-ce 
  "
  
  
  
  when: ansible_distribution == 'Ubuntu'


- name: Deploy docker app for Ubuntu 
  become: true
  become_method: "sudo"
  command: "docker run -d -p 80:80 vietlt215/lab01-angular-webapp"
  when: ansible_distribution == 'Ubuntu'
